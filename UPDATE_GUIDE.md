# çµæ„Ÿè·é˜µ - ä»£ç æ›´æ–°æŒ‡å—

## æ¦‚è¿°
å½“æ‚¨åœ¨GitHubä¸Šæ›´æ–°äº†ä»£ç åï¼Œéœ€è¦å°†æ›´æ–°åŒæ­¥åˆ°é˜¿é‡Œäº‘æœåŠ¡å™¨ã€‚æœ¬æŒ‡å—æä¾›äº†ä¸¤ç§æ›´æ–°æ–¹å¼ã€‚

## ğŸš€ æ›´æ–°æ–¹å¼

### æ–¹å¼ä¸€ï¼šå¿«é€Ÿæ›´æ–°ï¼ˆæ¨èï¼‰
é€‚ç”¨äºå°çš„ä»£ç ä¿®æ”¹ï¼Œä¸æ¶‰åŠä¾èµ–å˜æ›´æˆ–æ•°æ®åº“è¿ç§»ã€‚

```bash
# ä¸Šä¼ å¹¶æ‰§è¡Œå¿«é€Ÿæ›´æ–°è„šæœ¬
scp -o PreferredAuthentications=password scripts/quick-update.sh root@101.37.182.39:/tmp/
ssh -o PreferredAuthentications=password root@101.37.182.39 "chmod +x /tmp/quick-update.sh && /tmp/quick-update.sh"
```
è¿›å…¥é¡¹ç›®ç›®å½•å¹¶æ›´æ–°ä»£ç 
   cd /var/www/xhs_create_v3
   git fetch origin
   git reset --hard origin/main
   pm2 restart xhs-create-v3

   æ£€æŸ¥æ›´æ–°ç»“æœ
   pm2 status
   pm2 logs xhs-create-v3 --lines 10

   
### æ–¹å¼äºŒï¼šå®Œæ•´æ›´æ–°

é€‚ç”¨äºæ¶‰åŠä¾èµ–æ›´æ–°ã€æ•°æ®åº“è¿ç§»æˆ–é‡å¤§ä»£ç å˜æ›´çš„æƒ…å†µã€‚

```bash
# ä¸Šä¼ å¹¶æ‰§è¡Œå®Œæ•´æ›´æ–°è„šæœ¬
scp -o PreferredAuthentications=password scripts/update-from-github.sh root@101.37.182.39:/tmp/
ssh -o PreferredAuthentications=password root@101.37.182.39 "chmod +x /tmp/update-from-github.sh && /tmp/update-from-github.sh"
```

## ğŸ“ æ›´æ–°æ­¥éª¤è¯´æ˜

### å¿«é€Ÿæ›´æ–°æµç¨‹
1. æ˜¾ç¤ºå½“å‰ä»£ç ç‰ˆæœ¬
2. ä»GitHubæ‹‰å–æœ€æ–°ä»£ç 
3. é‡å¯PM2åº”ç”¨è¿›ç¨‹
4. æ£€æŸ¥åº”ç”¨çŠ¶æ€
5. æ˜¾ç¤ºæ›´æ–°åçš„æ—¥å¿—

### å®Œæ•´æ›´æ–°æµç¨‹
1. **å¤‡ä»½å½“å‰ç‰ˆæœ¬** - è‡ªåŠ¨åˆ›å»ºæ—¶é—´æˆ³å¤‡ä»½
2. **åœæ­¢åº”ç”¨** - é¿å…æ›´æ–°è¿‡ç¨‹ä¸­çš„å†²çª
3. **æ‹‰å–æœ€æ–°ä»£ç ** - ä»GitHub mainåˆ†æ”¯
4. **å®‰è£…ä¾èµ–** - ä½¿ç”¨pnpmå®‰è£…æ–°ä¾èµ–
5. **æ£€æŸ¥ç¯å¢ƒå˜é‡** - ç¡®ä¿.env.localå­˜åœ¨
6. **æ„å»ºé¡¹ç›®** - é‡æ–°æ„å»ºNext.jsåº”ç”¨
7. **æ£€æŸ¥æ•°æ®åº“è¿ç§»** - æç¤ºæ˜¯å¦æœ‰æ–°çš„è¿ç§»æ–‡ä»¶
8. **é‡å¯åº”ç”¨å’ŒNginx** - ç¡®ä¿æœåŠ¡æ­£å¸¸è¿è¡Œ
9. **æµ‹è¯•åŠŸèƒ½** - è‡ªåŠ¨æµ‹è¯•ä¸»è¦ç«¯ç‚¹
10. **æ˜¾ç¤ºæ›´æ–°æ‘˜è¦** - åŒ…å«å¤‡ä»½ä½ç½®å’Œç‰ˆæœ¬ä¿¡æ¯

## âš ï¸ æ³¨æ„äº‹é¡¹

### æ›´æ–°å‰æ£€æŸ¥
- ç¡®ä¿GitHubä¸Šçš„ä»£ç å·²ç»æµ‹è¯•é€šè¿‡
- å¦‚æœæœ‰æ•°æ®åº“å˜æ›´ï¼Œå…ˆå¤‡ä»½æ•°æ®åº“
- ç¡®è®¤æœåŠ¡å™¨æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´

### æ›´æ–°åéªŒè¯
1. è®¿é—® https://xhsmuse.art æ£€æŸ¥ä¸»é¡µ
2. æµ‹è¯•ç™»å½•åŠŸèƒ½
3. æµ‹è¯•æœç´¢å’Œæ”¹å†™åŠŸèƒ½
4. æ£€æŸ¥ç§¯åˆ†ç³»ç»Ÿæ˜¯å¦æ­£å¸¸

### æ•…éšœæ¢å¤
å¦‚æœæ›´æ–°åå‡ºç°é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¢å¤ï¼š

```bash
# æŸ¥çœ‹å¤‡ä»½åˆ—è¡¨
ls -la /var/www/backup_*

# æ¢å¤åˆ°æŒ‡å®šå¤‡ä»½ï¼ˆæ›¿æ¢æ—¶é—´æˆ³ï¼‰
rm -rf /var/www/xhs_create_v3
mv /var/www/backup_20241220_143000 /var/www/xhs_create_v3
pm2 restart xhs-create-v3
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **Gitæ‹‰å–å¤±è´¥**
   ```bash
   # é‡æ–°é…ç½®Gitè¿œç¨‹åœ°å€
   cd /var/www/xhs_create_v3
   git remote set-url origin https://github.com/æ‚¨çš„ç”¨æˆ·å/xhs_create_v3.git
   ```

2. **ä¾èµ–å®‰è£…å¤±è´¥**
   ```bash
   # æ¸…ç†ç¼“å­˜é‡æ–°å®‰è£…
   cd /var/www/xhs_create_v3
   rm -rf node_modules package-lock.json
   pnpm install
   ```

3. **åº”ç”¨å¯åŠ¨å¤±è´¥**
   ```bash
   # æ£€æŸ¥æ—¥å¿—
   pm2 logs xhs-create-v3
   
   # é‡å¯åº”ç”¨
   pm2 restart xhs-create-v3
   ```

4. **è®¤è¯é—®é¢˜**
   ```bash
   # è¿è¡Œè®¤è¯è¯Šæ–­è„šæœ¬
   scp -o PreferredAuthentications=password scripts/diagnose-auth-issues.sh root@101.37.182.39:/tmp/
   ssh -o PreferredAuthentications=password root@101.37.182.39 "chmod +x /tmp/diagnose-auth-issues.sh && /tmp/diagnose-auth-issues.sh"
   ```

## ğŸ“ æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. PM2è¿›ç¨‹çŠ¶æ€ï¼š`pm2 status`
2. åº”ç”¨æ—¥å¿—ï¼š`pm2 logs xhs-create-v3`
3. NginxçŠ¶æ€ï¼š`systemctl status nginx`
4. ç³»ç»Ÿèµ„æºï¼š`free -h` å’Œ `df -h`

## ğŸ¯ æœ€ä½³å®è·µ

1. **å®šæœŸæ›´æ–°** - å»ºè®®æ¯å‘¨æ›´æ–°ä¸€æ¬¡
2. **å°æ­¥å¿«è·‘** - é¢‘ç¹å°æ›´æ–°æ¯”å¤§æ›´æ–°æ›´å®‰å…¨
3. **å¤‡ä»½é‡è¦** - æ¯æ¬¡æ›´æ–°å‰éƒ½ä¼šè‡ªåŠ¨å¤‡ä»½
4. **æµ‹è¯•ä¼˜å…ˆ** - æœ¬åœ°æµ‹è¯•é€šè¿‡åå†éƒ¨ç½²
5. **ç›‘æ§æ—¥å¿—** - æ›´æ–°åå¯†åˆ‡å…³æ³¨åº”ç”¨æ—¥å¿— 